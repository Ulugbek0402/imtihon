<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Budget History | FinanceHome</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <style>
        body { background-color: #f8f9fa; font-family: 'Inter', sans-serif; }
        .sidebar { width: 260px; height: 100vh; position: fixed; background: #fff; border-right: 1px solid #eee; padding: 30px 20px; display: flex; flex-direction: column; }
        .main-content { margin-left: 260px; padding: 40px; }
        .nav-link { color: #666; padding: 12px; border-radius: 12px; margin-bottom: 5px; font-weight: 500; }
        .nav-link.active { background: #ffc107; color: #000 !important; }
        .budget-card { border: none; border-radius: 20px; background: #fff; box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin-bottom: 30px; overflow: hidden; }
        .budget-header { background: #fff; border-bottom: 1px solid #eee; padding: 20px; }
    </style>
</head>
<body>

<div class="sidebar">
    <h4 class="fw-bold text-primary mb-5 px-2">ðŸ’° FinanceHome</h4>
    <ul class="nav flex-column mb-auto">
        <li class="nav-item"><a class="nav-link" href="{% url 'home' %}"><i class="bi bi-speedometer2 me-2"></i> Dashboard</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'history' %}"><i class="bi bi-clock-history me-2"></i> Transactions</a></li>
        <li class="nav-item"><a class="nav-link active" href="{% url 'budget_list' %}"><i class="bi bi-pie-chart me-2"></i> Budgets</a></li>
    </ul>
</div>

<div class="main-content">
    <h2 class="fw-bold mb-4">Budget History</h2>

    {% for item in budget_data %}
    <div class="budget-card">
        <div class="budget-header d-flex justify-content-between align-items-center">
            <div>
                <h5 class="fw-bold mb-0 text-uppercase text-warning">{{ item.info.category }}</h5>
                <small class="text-muted">Limit: {{ item.info.amount_limit }} {{ item.info.currency.code }}</small>
            </div>
            <div class="text-end">
                <span class="badge bg-danger rounded-pill px-3">Spent: {{ item.total_spent }}</span>
            </div>
        </div>
        <div class="p-0">
            <table class="table table-hover mb-0 align-middle">
                <thead class="table-light small">
                    <tr>
                        <th class="ps-4">DATE</th>
                        <th>ACCOUNT</th>
                        <th class="text-end pe-4">AMOUNT</th>
                    </tr>
                </thead>
                <tbody>
                    {% for t in item.transactions %}
                    <tr>
                        <td class="ps-4 small text-muted">{{ t.date|date:"d M, Y" }}</td>
                        <td class="fw-bold small">{{ t.account.name }}</td>
                        <td class="text-end pe-4 fw-bold text-danger">-{{ t.amount }} {{ t.account.currency.code }}</td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="3" class="text-center py-4 text-muted small">No expenses for this budget yet.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    {% empty %}
    <div class="text-center py-5">
        <i class="bi bi-pie-chart display-1 text-muted opacity-25"></i>
        <p class="mt-3 text-muted">No budgets found. Create one in Dashboard!</p>
    </div>
    {% endfor %}
</div>

</body>
</html>